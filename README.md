# bert_IMDb

## 使用BERT模型对IMDb评论数据进行二分类（情感极性分析）
环境：Google公司的Colaboratory笔记本，使用GPU（Tesla M4）进行加速

数据集：train.csv, test.csv 以及 train.pickle使用pickle格式存储

已封装代码：bert_review_classification.ipynb文件

运行结果见上述代码输出结果（设置epoch为3）

**模型准确度为88.93%(依照官方的demo超参数设置)**

**模型准确度为92.48%(本小组自行调整的最佳超参数下最佳结果)**

---

### 仓库目录向导：

1. 根目录下 bert_review_classification.ipynb 文件为完整数据集下，调整超参数至性能最佳的结果

   > 超参数设置如下：
   >
   > * epoch 为3
   > * learning rate 为2e-5
   > * max_seq_length 为128

2. bert_epoch_test 文件夹下为不同epoch的测试结果

3. bert_learning_rate_test 文件夹下为不同learning rate的测试结果

4. bert_max_seq_len_test 文件夹下为不同max_sequence_length的测试结果

5. bert_dataset_size_test 文件夹下为不同数据集规模下的测试结果

6. train.csv 和 test.csv 分别是清洗好的训练集数据和测试集数据

7. dataset_backup 是数据集的其他存储方式数据

8. MachineLearning 文件夹下为机器学习方法

   > 分别是如下算法：
   >
   > * Naive Bayes 朴素贝叶斯
   > * LinearSVC 

9. LSTM 文件夹下使用 LSTM 模型的测试结果
10. CNN   文件夹下使用 CNN  模型的测试结果
11. IMDB_Loader 文件是IMDb数据集的数据预处理文件

---

与其他深度学习方法的对比结果表格如下：

| 模型 | 准确率（accuracy） |  loss  | f1 score |
| :--: | :----------------: | :----: | :------: |
| Bert |       88.93%       | 0.4938 |  88.51%  |
| LSTM |       77.20%       | 0.2757 |    /     |
| CNN  |       71.99%       | 1.0485 |    /     |



## 调整超参数测试

#### 1. 调整epoch

| 迭代次数 | 准确率（accuracy） |  loss  | f1 score |
| :------: | :----------------: | :----: | :------: |
|    1     |       86.18%       | 0.6760 |  85.11%  |
|    2     |       89.03%       | 0.3514 |  89.44%  |
|    3     |       88.93%       | 0.4938 |  88.51%  |
|    6     |       88.20%       | 0.7211 |  87.62%  |
|    10    |                    |        |          |

#### 2. 调整learning rate

| 学习速率 | 准确率（accuracy） |  loss  | f1 score |
| :------: | :----------------: | :----: | :------: |
|   2e-5   |       88.93%       | 0.4938 |  88.51%  |
|   1e-4   |       86.10%       | 0.6764 |  85.02%  |

#### 3. 调整max_seq_length

| 最大序列长度 | 准确率（accuracy） |  loss  | f1 score |
| :----------: | :----------------: | :----: | :------: |
|      64      |       84.11%       | 0.7008 |  85.06%  |
|     128      |       88.93%       | 0.4938 |  88.51%  |
|     256      |       92.48%       | 0.3190 |  92.27%  |



## 调整训练集大小

| 训练集大小 | 准确率（accuracy） |  loss  | f1 score |
| :--------: | :----------------: | :----: | :------: |
|   52000    |       88.93%       | 0.4938 |  88.51%  |
|   10000    |       88.13%       | 0.5017 |  87.92%  |
|    3000    |       85.70%       | 0.4938 |  86.64%  |
|    1000    |       83.61%       | 0.4974 |  84.45%  |
|    500     |       77.84%       | 0.5035 |  80.27%  |

未来可能加入不同训练集规模下，与其他模型的性能对比